<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Data Visualization in R with ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Ali Seyhun Saral" />
    <meta name="date" content="2019-06-29" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/shinobi.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/tamu-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data Visualization in R with ggplot2
### Ali Seyhun Saral
### Jdmx 2019
### 2019-06-29

---


&lt;link href="https://fonts.googleapis.com/css?family=Anton|Average|Fjalla+One|Gravitas+One|Montserrat&amp;display=swap" rel="stylesheet"&gt; 


### `ggplot2`: What does gg stand for?

Wilkinson(2005): The Grammar of Graphics   

--

 _A statistical graphic is a __mapping__ from data to __aesthetic__ attributes (color, shape, size) of __geometric objects__ (points, lines, bars)_. 
 
--

- Set of independent components:

    - Data
 
    - Layers

        - Geometric objects (geoms)

        - Statistical Transformations (stats)

    - Scales (scale)

    - Coordinate system (coord)

    - Facets (facet)

    - Theme (theme)

---
## Let's get started
Go to:
### [saral.it/jdmx](https://saral.it/jdmx)

---
### Mappings

&lt;img src="./img/flow.png" width="100%" style="display: block; margin: auto;" /&gt;

* aes() is responsible for defining mappings
.pull-left[

```r
head(my_data)
```

```
##   class study_hours score
## 1     A          28    63
## 2     A          21    59
## 3     A          14    40
## 4     A          29    78
## 5     A          16    37
## 6     A          28    60
```
]
.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;
]
---
### Data

* World Happiness Report by UN Sustainable Development Solutions Network


```r
 head(happiness_data)
```

```
##       country happiness gdp_per_capita social_support life_expectancy
## 1     Finland     7.632          1.305          1.592           0.874
## 2      Norway     7.594          1.456          1.582           0.861
## 3     Denmark     7.555          1.351          1.590           0.868
## 4     Iceland     7.495          1.343          1.644           0.914
## 5 Switzerland     7.487          1.420          1.549           0.927
## 6 Netherlands     7.441          1.361          1.488           0.878
##   freedom generosity corruption continent
## 1   0.681      0.192        106    Europe
## 2   0.686      0.286        102    Europe
## 3   0.683      0.284        107    Europe
## 4   0.677      0.353         77    Europe
## 5   0.660      0.256        103    Europe
## 6   0.638      0.333         98    Europe
```
---
### Our first `ggplot2` graph
The relationship between `happiness` and `gdp_per_capita`.
&lt;img src="presentation_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /&gt;
---
### Initializing the canvas (Step 1)
* Load `ggplot2` library 
* We use `ggplot()` function (not ggplot2)
* Define the data frame
* Define the aesthetic mappings with `aes()`


```r
ggplot(happiness_data, aes( x = gdp_per_capita, y = happiness))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-8-1.png" width="40%" style="display: block; margin: auto;" /&gt;
---
### Adding `geom_point` (Step 2)
* Elements are added with `+` (must be at the end of the line)
* Create scatterplots and bubble charts
* Can take `x`, `y`, `color`, `size`, `alpha` ...
* Documentation for `geom_point`:   
  https://ggplot2.tidyverse.org/reference/geom_point.html

```r
ggplot(happiness_data, aes( x = gdp_per_capita, y = happiness)) +
  geom_point()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-9-1.png" width="30%" style="display: block; margin: auto;" /&gt;
* geoms inherit aesthetic mappings from the top level of the plot, which is the `ggplot()` function
---
### Adding `geom_text` 
* Elements are added with `+` (must be at the end of the line)
* Create scatterplots and bubble charts
* Can take `x`, `y`, `color`, `size`, `alpha` ...
* Documentation for `geom_point`:   
  https://ggplot2.tidyverse.org/reference/geom_text.html

```r
ggplot(happiness_data, aes( x = gdp_per_capita, y = happiness)) +
  geom_text(aes(label = country))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-10-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Coloring vs. Mapping to a Color
* If we want to color a geom, we should add the parameter directly

```r
ggplot(happiness_data, aes( x = gdp_per_capita, y = happiness)) +
  geom_point(color = "red")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-11-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
#  Coloring vs. Mapping to a Color
* If we want to map a variable to the color, we use `aes()`

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness,
                           color = continent)) +
  geom_point()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-12-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Coloring vs. Mapping to a Color (Step 3)
* Note that we could put the color aesthetic in `geom_point()` as well.

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes(color = continent))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-13-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Mapping to a Shape Instead


```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes(shape = continent))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-14-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Or both


```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes(shape = continent, color = continent))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-15-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### We can even add a size mapping


```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes( color = continent, size = generosity))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-16-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Let's stick to the previous one

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes( color = continent))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-17-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Setting the axis limits (Step 4 -&gt;)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes( color = continent)) +
    scale_y_continuous( limits = c(0,8)) 
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-18-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Setting the axis breaks (-&gt; Step 4 -&gt;)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes( color = continent)) +
    scale_y_continuous( limits = c(0,8), breaks = 0:8) 
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-19-1.png" width="50%" style="display: block; margin: auto;" /&gt;
`seq()` function can be handy to set axis breaks.
---
### Setting axis names (-&gt; Step 4)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
    geom_point(aes( color = continent)) +
    scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
      scale_x_continuous(name = "Log GDP per Capita")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-20-1.png" width="50%" style="display: block; margin: auto;" /&gt;
`seq()` function can be handy to set axis breaks.
---

### Scales

* Control how data map to visual properties
* `ggplot2` has well selected defaults, but often customization is needed
* There are several "ready to use" scales for different type of aesthethics

[`scale_x_discrete()`](https://ggplot2.tidyverse.org/reference/scale_discrete.html)  
[`scale_x_continuous()`](https://ggplot2.tidyverse.org/reference/scale_continuous.html)  
[`scale_shape()`](https://ggplot2.tidyverse.org/reference/scale_shape.html)  
[`scale_color_brewer()`](https://ggplot2.tidyverse.org/reference/scale_brewer.html)  More information [Brewer Scale Palettes](http://colorbrewer2.org/#type=qualitative&amp;scheme=Set1&amp;n=3)  

* And can be built manually:

[DIY scales](https://ggplot2.tidyverse.org/reference/scale_manual.html)
```
scale_colour_manual() 
scale_fill_manual() 
scale_size_manual() 
scale_shape_manual() 
scale_linetype_manual() 
scale_alpha_manual()
scale_discrete_manual() 
```

---
### Setting color scale : Brewer palette (Step 5)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes( color = continent)) +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
    scale_x_continuous(name = "Log GDP per Capita") +
    scale_color_brewer(name = "Continent", palette = "Set1")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-21-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Setting color scale : Custom

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes( color = continent)) +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
    scale_x_continuous(name = "Log GDP per Capita") +
    scale_color_manual(name = "Continent",
                       values = c("blue", "orange", "red", "purple", "cyan"))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-22-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Setting color scale : Custom

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes( color = continent)) +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
    scale_x_continuous(name = "Log GDP per Capita") +
    scale_color_manual(name = "Continent",
                       values = c("blue", "orange", "red", "purple", "cyan"),
                       labels = c("AFR","AMR","ASI","EUR","OCE"))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-23-1.png" width="45%" style="display: block; margin: auto;" /&gt;
---
### Adding `geom_smooth()`(Step 6)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes( color = continent)) +
  geom_smooth() +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
  scale_x_continuous(name = "Log GDP per Capita") +
  scale_color_brewer(palette = "Set1")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-24-1.png" width="60%" style="display: block; margin: auto;" /&gt;
---
### Adding linear `geom_smooth()` (Step 7)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes( color = continent)) +
  geom_smooth(method = "lm") +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
  scale_x_continuous(name = "Log GDP per Capita") +
  scale_color_brewer(palette = "Set1")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-25-1.png" width="60%" style="display: block; margin: auto;" /&gt;
---
### Final Touches (Step 7)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes(color = continent), alpha = 0.5) +
  geom_smooth(method = "lm", se= FALSE, color = "black") +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
  scale_x_continuous(name = "Log GDP per Capita") +
  scale_color_brewer(name = "", palette = "Set1") +
  theme_bw()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-26-1.png" width="60%" style="display: block; margin: auto;" /&gt;
---
### Facetting (Bonus Step)

```r
ggplot(happiness_data, aes(x = gdp_per_capita,
                           y = happiness)) +
  geom_point(aes(color = continent), alpha = 0.5) +
  geom_smooth(method = "lm", se= FALSE, color = "black") +
  scale_y_continuous(name = "Happiness index", limits = c(0,8), breaks = 0:8) +
  scale_x_continuous(name = "Log GDP per Capita") +
  scale_color_brewer(palette = "Set1") +
  facet_grid( ~ continent) +
  theme_bw()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /&gt;
---
### Before we go on:
&lt;img src="./img/googling.png" width="60%" style="display: block; margin: auto;" /&gt;
---

&lt;img src="./img/googling3.png" width="80%" style="display: block; margin: auto;" /&gt;
---
&lt;img src="./img/googling4.png" width="80%" style="display: block; margin: auto;" /&gt;

--

&lt;img src="./img/googling2.png" width="80%" style="display: block; margin: auto;" /&gt;

---
### Bar charts in ggplot
* `geom_col()`: General mapping
    * x: categorical variable
    * y: bar height
    
* `geom_bar()`: Used for counting instances in data
    * x: categorical variable
---
### Bar charts in ggplot : geom_col()

```r
library(dplyr)
happiness_data_subset  &lt;- happiness_data  %&gt;% filter( country %in% c("Italy", "Germany", "Turkey") )
head(happiness_data_subset)
```

```
##   country happiness gdp_per_capita social_support life_expectancy freedom
## 1 Germany     6.965          1.340          1.474           0.861   0.586
## 2   Italy     6.000          1.264          1.501           0.946   0.281
## 3  Turkey     5.483          1.148          1.380           0.686   0.324
##   generosity corruption continent
## 1      0.273         95    Europe
## 2      0.137         12    Europe
## 3      0.106         64      Asia
```
---
### Bar charts in ggplot : geom_col()

```r
ggplot(happiness_data_subset, aes(x = country, y = happiness)) +
  geom_col()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-33-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Bar charts in ggplot : geom_col()

```r
library(dplyr)
ggplot(happiness_data_subset, aes(x = country, y = happiness)) +
  geom_point(size = 4) +
  scale_y_continuous(limits = c(0,8)) +
  coord_flip()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-34-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Nobel Prize Data
* ex2.R




```r
glimpse(nobel_winners)
```

```
## Observations: 969
## Variables: 20
## $ prize_year           &lt;dbl&gt; 1901, 1901, 1901, 1901, 1901, 1901, 1902, 1…
## $ category             &lt;chr&gt; "Chemistry", "Literature", "Medicine", "Pea…
## $ prize                &lt;chr&gt; "The Nobel Prize in Chemistry 1901", "The N…
## $ motivation           &lt;chr&gt; "\"in recognition of the extraordinary serv…
## $ prize_share          &lt;chr&gt; "1/1", "1/1", "1/1", "1/2", "1/2", "1/1", "…
## $ laureate_id          &lt;dbl&gt; 160, 569, 293, 462, 463, 1, 161, 571, 294, …
## $ laureate_type        &lt;chr&gt; "Individual", "Individual", "Individual", "…
## $ full_name            &lt;chr&gt; "Jacobus Henricus van 't Hoff", "Sully Prud…
## $ birth_date           &lt;date&gt; 1852-08-30, 1839-03-16, 1854-03-15, 1828-0…
## $ birth_city           &lt;chr&gt; "Rotterdam", "Paris", "Hansdorf (Lawice)", …
## $ birth_country        &lt;chr&gt; "Netherlands", "France", "Prussia (Poland)"…
## $ gender               &lt;chr&gt; "Male", "Male", "Male", "Male", "Male", "Ma…
## $ organization_name    &lt;chr&gt; "Berlin University", NA, "Marburg Universit…
## $ organization_city    &lt;chr&gt; "Berlin", NA, "Marburg", NA, NA, "Munich", …
## $ organization_country &lt;chr&gt; "Germany", NA, "Germany", NA, NA, "Germany"…
## $ death_date           &lt;date&gt; 1911-03-01, 1907-09-07, 1917-03-31, 1910-1…
## $ death_city           &lt;chr&gt; "Berlin", "Châtenay", "Marburg", "Heiden", …
## $ death_country        &lt;chr&gt; "Germany", "France", "Germany", "Switzerlan…
## $ birth_year           &lt;chr&gt; "1852", "1839", "1854", "1828", "1822", "18…
## $ age_awarded          &lt;dbl&gt; 49, 62, 47, 73, 79, 56, 50, 85, 45, 69, 59,…
```
---
### Bar Charts: geom_bar()
* Let's create our first plot
* Note that geom_bar automatically counts the number of instances (default behavior)


```r
ggplot(nobel_winners, aes(x = category))+
  geom_bar()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-37-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Bar Charts: geom_bar()
* Two types of bar charts in ggplot: `geom_bar()` and `geom_col`.
* `geom_col()` is a simple 
* Let's create our first plot
* Note that geom_bar automatically counts the number of instances (default behavior)


```r
ggplot(nobel_winners, aes(x = category, fill = gender))+
  geom_bar()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-38-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Investigating the data
What are the NA's?


```r
nobel_winners  %&gt;% filter(is.na(gender))  %&gt;% select(full_name)
```

```
## # A tibble: 26 x 1
##    full_name                                                               
##    &lt;chr&gt;                                                                   
##  1 Institut de droit international (Institute of International Law)        
##  2 Bureau international permanent de la Paix (Permanent International Peac…
##  3 Comité international de la Croix Rouge (International Committee of the …
##  4 Office international Nansen pour les Réfugiés (Nansen International Off…
##  5 Comité international de la Croix Rouge (International Committee of the …
##  6 Friends Service Council (The Quakers)                                   
##  7 American Friends Service Committee (The Quakers)                        
##  8 Office of the United Nations High Commissioner for Refugees (UNHCR)     
##  9 Comité international de la Croix Rouge (International Committee of the …
## 10 Ligue des Sociétés de la Croix-Rouge (League of Red Cross Societies)    
## # … with 16 more rows
```

```r
library(dplyr)
unique(nobel_winners$laureate_type)
```

```
## [1] "Individual"   "Organization"
```
---
### Let's take individual laureates only 

```r
nobel_winners_ind  &lt;- nobel_winners  %&gt;% filter(laureate_type == "Individual")
```
---
### Let's take individual laureates only 

```r
ggplot(nobel_winners_ind, aes(x = category, fill = gender))+
  geom_bar()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-42-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Different possibilities

```r
ggplot(nobel_winners_ind, aes(x = category, fill = gender))+
  geom_bar(position = "dodge")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-43-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Different possibilities

```r
ggplot(nobel_winners_ind, aes(x = category, fill = gender))+
  geom_bar(position = "fill")
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-44-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### A continous and a categorical variable: geom_boxplot()

```r
ggplot(nobel_winners, aes(y = age_awarded, x = category)) +
  geom_point()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-45-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Layering up: geom_jitter() and geom_boxplot()

```r
ggplot(nobel_winners, aes(y = age_awarded, x = category)) +
  geom_jitter() +
  geom_boxplot(fill = NA, color = "blue", outlier.shape = NA)
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-46-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---

```r
ggplot(nobel_winners, aes(x = age_awarded)) +
  geom_histogram() +
  facet_grid(category ~ .)
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-47-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---


```r
ggplot(nobel_winners, aes(x = age_awarded)) +
  geom_density(fill = "blue") +
  facet_grid(category ~ .)
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-48-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---



```r
nobel_winners  %&gt;%
  filter(!is.na(age_awarded))  %&gt;%
  group_by(prize_year)  %&gt;%
  summarise( mean_age = mean(age_awarded))  %&gt;% 
ggplot(aes(x = prize_year, y = mean_age )) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = seq(1800,2019,10)) +
scale_y_continuous(limits = c(15,99))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-49-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---

```r
nobel_winners  %&gt;%
  filter(!is.na(age_awarded))  %&gt;%
  group_by(prize_year)  %&gt;%
  summarise( mean_age = mean(age_awarded))  %&gt;% 
ggplot(aes(x = prize_year, y = mean_age )) +
geom_point() +
geom_line() +
geom_smooth() +
scale_x_continuous(breaks = seq(1800,2019,10)) +
scale_y_continuous(limits = c(15,99))
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-50-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---


```r
nobel_winners  %&gt;%
  filter(!is.na(age_awarded))  %&gt;%
  group_by(prize_year, category)  %&gt;%
  summarise( mean_age = mean(age_awarded))  %&gt;% 
ggplot(aes(x = prize_year, y = mean_age )) +
geom_point() +
geom_line() +
geom_smooth(method = "lm", se = FALSE) +
scale_x_continuous(breaks = seq(1800,2019,10)) +
scale_y_continuous(limits = c(15,99)) +
facet_grid(category ~ .)
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-51-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
### Jittered geom_point: geom_jitter()
* Summarizes the date into five values

```r
ggplot(nobel_winners, aes(y = age_awarded, x = category)) +
  geom_jitter()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-52-1.png" width="50%" style="display: block; margin: auto;" /&gt;
---
# Here we go
---
&lt;img src="presentation_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;" /&gt;
---

```r
library(rworldmap)
library(ggplot2)
map_world &lt;- map_data(map="world")

#Add the data you want to map countries by to map.world
#In this example, I add lengths of country names plus some offset

map_world_happiness  &lt;- map_world  %&gt;% rename(country = region)  %&gt;% left_join(happiness_data, by = "country") 

map_world_new  &lt;- map_world  %&gt;% rename(country = region) 

ggplot() +
  geom_map(data=map_world_happiness, map=map_world, aes(map_id=country, x=long, y=lat, fill=happiness)) +
  coord_equal()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-54-1.png" style="display: block; margin: auto;" /&gt;
---

```r
library(rworldmap)
library(ggplot2)
map_world &lt;- map_data(map="world")

#Add the data you want to map countries by to map.world
#In this example, I add lengths of country names plus some offset

map_world_happiness  &lt;- map_world  %&gt;% rename(country = region)  %&gt;% left_join(happiness_data, by = "country") 

map_world_new  &lt;- map_world  %&gt;% rename(country = region) 

ggplot() +
  geom_map(data=map_world_happiness, map=map_world, aes(map_id=country, x=long, y=lat, fill=happiness), color = "black", size =0.2) +
  scale_fill_distiller(direction = 1) +
  coord_equal()
```

&lt;img src="presentation_files/figure-html/unnamed-chunk-55-1.png" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
